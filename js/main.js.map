{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./ts/core/RelatiBoard.ts","webpack:///./ts/core/RelatiRoutes.ts","webpack:///./ts/core/GridBoard.ts","webpack:///./ts/core/SVGProcess.ts","webpack:///./index.ts","webpack:///./scss/view/RelatiEffectView.scss?a03b","webpack:///./scss/view/RelatiEffectView.scss","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./ts/core/RelatiGame.ts","webpack:///./ts/core/RelatiAction.ts","webpack:///./ts/view/RelatiBoardView.ts","webpack:///./ts/view/RelatiEffectView.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","GridBoard_1","RELATI_SYMBOL_N","RELATI_SYMBOL_O","RELATI_SYMBOL_X","RELATI_RECEIVER","RELATI_REPEATER","RELATI_LAUNCHER","RelatiGrid","_super","board","x","y","_this","this","body","__extends","is","status","gain","lost","symbol","Grid","RelatiBoard","width","height","grid","grids","GridBoard","DRCT_F","GRID_DRCT","DRCT_B","DRCT_R","DRCT_L","DRCT_FR","DRCT_FL","DRCT_BR","DRCT_BL","DRCT_2F","DRCT_2B","DRCT_2R","DRCT_2L","DRCT_2FR","DRCT_2FL","DRCT_2BR","DRCT_2BL","DRCT_FFR","DRCT_FFL","DRCT_BBR","DRCT_BBL","DRCT_FRR","DRCT_FLL","DRCT_BRR","DRCT_BLL","NORMAL_ROUTES","REMOTE_NORMAL_ROUTES","REMOTE_STABLE_ROUTES","BY_NORMAL_RELATI","BY_COMMON_RELATI","getRelatiRoutesBy","routeType","routes","targetGrid","getGrid","middleGrid1","middleGrid2","isSpace","push","middleGrid","hasRelatiRoutesBy","getRelatiTracesBy","drct","f","b","length","SVGNS","updateSVG","element","attribute","name_1","setAttribute","createSVG","tagName","document","createElementNS","RelatiBoard_1","RelatiGame_1","RelatiRoutes_1","RelatiBoardView_1","RelatiEffectView_1","game","RelatiGame","boardView","RelatiBoardView","resize","window","addEventListener","view","event","Math","floor","offsetX","offsetY","playerSymbol","nowPlayerSymbol","selectGrid","background","update","removeBackground","createHintEffect","getPlaceableGrid","createRelatiEffect","content","options","hmr","transform","insertInto","undefined","locals","useSourceMap","list","toString","map","item","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","concat","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","id","fn","memo","stylesInDom","isOldIE","all","atob","apply","arguments","getElement","target","parent","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","attrs","type","nonce","nc","getNonce","addAttrs","el","keys","forEach","obj","remove","result","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","href","styleSheet","cssText","createTextNode","newObj","DEBUG","newList","mayRemove","textStore","replaceText","index","replacement","filter","Boolean","cssNode","childNodes","location","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","RelatiAction_1","turn","destoryRepeaterBy","restoreRepeaterBy","_i","_a","placeableGrid","restore","routes_1","SVGProcess_1","container","gridViews","linesContainer","lineAttr","stroke","stroke-width","line","gridView","RelatiGridView","_b","min","clientWidth","clientHeight","childCount","symbolAttr","fill","srtX","srtY","endX","endY","color","RELATI_EFFECTED","SYMBOL_COLOR","dotAttr","cx","cy","createDot","grids_1","class","createLine","traces","traces_1","path","createRelatiLine","setTimeout","traces_2","grids_2","grids_3"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","import { Grid, GridBoard } from \"./GridBoard\";\n\n/** 無符號 */\nexport const RELATI_SYMBOL_N = 0b00000000;\n/** 符號為圓圈 */\nexport const RELATI_SYMBOL_O = 0b00000001;\n/** 符號為交叉 */\nexport const RELATI_SYMBOL_X = 0b00000010;\n\n/** 狀態為接收器 */\nexport const RELATI_RECEIVER = 0b00001000;\n/** 狀態為中繼器 */\nexport const RELATI_REPEATER = 0b00010000;\n/** 狀態為發射器 */\nexport const RELATI_LAUNCHER = 0b00100000;\n\n/** Relati棋盤格 */\nexport interface RelatiGrid extends Grid {\n    getGrid(drct: number): RelatiGrid;\n}\n\nexport class RelatiGrid extends Grid {\n    /** 棋盤內部 */\n    public body: number = 0;\n\n    constructor(board: RelatiBoard, x: number, y: number) {\n        super(board, x, y);\n    }\n\n    /**\n     * 判斷是否符號狀態\n     * @param status 狀態\n     */\n    is(status: number) {\n        return (this.body & status) === status;\n    }\n\n    /**\n     * 獲得指定狀態\n     * @param status 狀態\n     */\n    gain(status: number) {\n        return this.body |= status;\n    }\n\n    /**\n     * 失去指定狀態\n     * @param status 狀態\n     */\n    lost(status: number) {\n        return this.body &= ~status;\n    }\n\n    /**\n     * 取得符號\n     */\n    get symbol() {\n        return this.body & 0b00000111;\n    }\n\n    /**\n     * 設置符號\n     * @param symbol 符號\n     */\n    set symbol(symbol: number) {\n        this.lost(0b00000111);\n        this.gain(symbol);\n    }\n\n    /**\n     * 是否為空白\n     */\n    get isSpace() {\n        return this.body === RELATI_SYMBOL_N;\n    }\n}\n\n/** Relati棋盤 */\nexport interface RelatiBoard extends GridBoard {\n    grids: RelatiGrid[];\n    getGrid(x: number, y: number): RelatiGrid;\n}\n\nexport class RelatiBoard extends GridBoard {\n    constructor(width: number, height: number) {\n        super(width, height);\n\n        for (let x = 0; x < width; x++) {\n            for (let y = 0; y < height; y++) {\n                let grid: RelatiGrid = new RelatiGrid(this, x, y);\n                this.grids[grid.i] = grid;\n            }\n        }\n    }\n}","import { GRID_DRCT } from \"./GridBoard\";\nimport { RelatiGrid } from \"./RelatiBoard\";\n\nlet {\n    DRCT_F, DRCT_B, DRCT_R, DRCT_L,\n    DRCT_FR, DRCT_FL, DRCT_BR, DRCT_BL,\n    DRCT_2F, DRCT_2B, DRCT_2R, DRCT_2L,\n    DRCT_2FR, DRCT_2FL, DRCT_2BR, DRCT_2BL,\n    DRCT_FFR, DRCT_FFL, DRCT_BBR, DRCT_BBL,\n    DRCT_FRR, DRCT_FLL, DRCT_BRR, DRCT_BLL\n} = GRID_DRCT;\n\n/** 一般Relati路徑 */\nconst NORMAL_ROUTES = [\n    DRCT_F, DRCT_B, DRCT_R, DRCT_L,\n    DRCT_FR, DRCT_FL, DRCT_BR, DRCT_BL\n];\n\n/** 遠程Relati路徑 */\nconst REMOTE_NORMAL_ROUTES = [\n    [DRCT_2F, DRCT_F],\n    [DRCT_2B, DRCT_B],\n    [DRCT_2R, DRCT_R],\n    [DRCT_2L, DRCT_L],\n    [DRCT_2FR, DRCT_FR],\n    [DRCT_2FL, DRCT_FL],\n    [DRCT_2BR, DRCT_BR],\n    [DRCT_2BL, DRCT_BL]\n];\n\n/** 遠程穩定Relati路徑 */\nconst REMOTE_STABLE_ROUTES = [\n    [DRCT_FFR, DRCT_2F, DRCT_F],\n    [DRCT_FFR, DRCT_FR, DRCT_F],\n    [DRCT_FFR, DRCT_FR, DRCT_R],\n    [DRCT_FFL, DRCT_2F, DRCT_F],\n    [DRCT_FFL, DRCT_FL, DRCT_F],\n    [DRCT_FFL, DRCT_FL, DRCT_L],\n    [DRCT_BBR, DRCT_2B, DRCT_B],\n    [DRCT_BBR, DRCT_BR, DRCT_B],\n    [DRCT_BBR, DRCT_BR, DRCT_R],\n    [DRCT_BBL, DRCT_2B, DRCT_B],\n    [DRCT_BBL, DRCT_BL, DRCT_B],\n    [DRCT_BBL, DRCT_BL, DRCT_L],\n    [DRCT_FRR, DRCT_FR, DRCT_F],\n    [DRCT_FRR, DRCT_2R, DRCT_R],\n    [DRCT_FRR, DRCT_FR, DRCT_R],\n    [DRCT_FLL, DRCT_FL, DRCT_F],\n    [DRCT_FLL, DRCT_2L, DRCT_L],\n    [DRCT_FLL, DRCT_FL, DRCT_L],\n    [DRCT_BRR, DRCT_BR, DRCT_B],\n    [DRCT_BRR, DRCT_2R, DRCT_R],\n    [DRCT_BRR, DRCT_BR, DRCT_R],\n    [DRCT_BLL, DRCT_BL, DRCT_B],\n    [DRCT_BLL, DRCT_2L, DRCT_L],\n    [DRCT_BLL, DRCT_BL, DRCT_L]\n];\n\n/** 使用一般Relati路徑類型 */\nexport const BY_NORMAL_RELATI = 0;\n\n/** 使用通用Relati路徑類型 */\nexport const BY_COMMON_RELATI = 1;\n\n/**\n * 取得Relati路徑\n * @param grid 棋盤格\n * @param status 狀態\n * @param routeType 路徑類型\n */\nexport function getRelatiRoutesBy(grid: RelatiGrid, status: number, routeType: number) {\n    let routes: RelatiGrid[] = [];\n\n    switch (routeType) {\n        case BY_COMMON_RELATI:\n            for (let i = 0; i < 24; i++) {\n                let targetGrid = grid.getGrid(REMOTE_STABLE_ROUTES[i][0]);\n                let middleGrid1 = grid.getGrid(REMOTE_STABLE_ROUTES[i][1]);\n                let middleGrid2 = grid.getGrid(REMOTE_STABLE_ROUTES[i][2]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status) &&\n                    middleGrid1.isSpace &&\n                    middleGrid2.isSpace\n                ) routes.push(targetGrid);\n            }\n\n            for (let i = 0; i < 8; i++) {\n                let targetGrid = grid.getGrid(REMOTE_NORMAL_ROUTES[i][0]);\n                let middleGrid = grid.getGrid(REMOTE_NORMAL_ROUTES[i][1]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status) &&\n                    middleGrid.isSpace\n                ) routes.push(targetGrid);\n            }\n        case BY_NORMAL_RELATI:\n            for (let i = 0; i < 8; i++) {\n                let targetGrid = grid.getGrid(NORMAL_ROUTES[i]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status)\n                ) routes.push(targetGrid);\n            }\n    }\n\n    return routes;\n}\n\n/**\n * 是否有Relati路徑\n * @param grid 棋盤格\n * @param status 狀態\n * @param routeType 路徑類型\n */\nexport function hasRelatiRoutesBy(grid: RelatiGrid, status: number, routeType: number) {\n    switch (routeType) {\n        case BY_COMMON_RELATI:\n            for (let i = 0; i < 24; i++) {\n                let targetGrid = grid.getGrid(REMOTE_STABLE_ROUTES[i][0]);\n                let middleGrid1 = grid.getGrid(REMOTE_STABLE_ROUTES[i][1]);\n                let middleGrid2 = grid.getGrid(REMOTE_STABLE_ROUTES[i][2]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status) &&\n                    middleGrid1.isSpace &&\n                    middleGrid2.isSpace\n                ) return true;\n            }\n\n            for (let i = 0; i < 8; i++) {\n                let targetGrid = grid.getGrid(REMOTE_NORMAL_ROUTES[i][0]);\n                let middleGrid = grid.getGrid(REMOTE_NORMAL_ROUTES[i][1]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status) &&\n                    middleGrid.isSpace\n                ) return true;\n            }\n        case BY_NORMAL_RELATI:\n            for (let i = 0; i < 8; i++) {\n                let targetGrid = grid.getGrid(NORMAL_ROUTES[i]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status)\n                ) return true;\n            }\n    }\n\n    return false;\n}\n\n/**\n * 追溯Relati路徑\n * @param grid 棋盤格\n * @param status 狀態\n * @param routeType 路徑類型\n */\nexport function getRelatiTracesBy(grid: RelatiGrid, status: number, routeType: number) {\n    let routes: RelatiGrid[][] = [];\n\n    switch (routeType) {\n        case BY_COMMON_RELATI:\n            for (let i = 0; i < 24; i++) {\n                let targetGrid = grid.getGrid(REMOTE_STABLE_ROUTES[i][0]);\n                let middleGrid1 = grid.getGrid(REMOTE_STABLE_ROUTES[i][1]);\n                let middleGrid2 = grid.getGrid(REMOTE_STABLE_ROUTES[i][2]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status) &&\n                    middleGrid1.isSpace &&\n                    middleGrid2.isSpace\n                ) routes.push([middleGrid2, middleGrid1, targetGrid]);\n            }\n\n            for (let i = 0; i < 8; i++) {\n                let targetGrid = grid.getGrid(REMOTE_NORMAL_ROUTES[i][0]);\n                let middleGrid = grid.getGrid(REMOTE_NORMAL_ROUTES[i][1]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status) &&\n                    middleGrid.isSpace\n                ) routes.push([middleGrid, targetGrid]);\n            }\n        case BY_NORMAL_RELATI:\n            for (let i = 0; i < 8; i++) {\n                let targetGrid = grid.getGrid(NORMAL_ROUTES[i]);\n\n                if (\n                    targetGrid &&\n                    targetGrid.is(status)\n                ) routes.push([targetGrid]);\n            }\n    }\n\n    return routes;\n}","/**\n * 棋盤格方向\n * C: (x = 0, y = 0)\n * F: (x = x, y - 1)\n * B: (x = x, y + 1)\n * R: (x + 1, y = y)\n * L: (x - 1, y = y)\n */\nexport enum GRID_DRCT {\n    DRCT_C = 0x0000,\n    DRCT_F = 0x1000,\n    DRCT_B = 0x0100,\n    DRCT_R = 0x0010,\n    DRCT_L = 0x0001,\n    DRCT_FR = 0x1010,\n    DRCT_FL = 0x1001,\n    DRCT_BR = 0x0110,\n    DRCT_BL = 0x0101,\n\n    DRCT_2F = 0x2000,\n    DRCT_2B = 0x0200,\n    DRCT_2R = 0x0020,\n    DRCT_2L = 0x0002,\n    DRCT_2FR = 0x2020,\n    DRCT_2FL = 0x2002,\n    DRCT_2BR = 0x0220,\n    DRCT_2BL = 0x0202,\n\n    DRCT_FFR = 0x2010,\n    DRCT_FFL = 0x2001,\n    DRCT_BBR = 0x0210,\n    DRCT_BBL = 0x0201,\n    DRCT_FRR = 0x1020,\n    DRCT_FLL = 0x1002,\n    DRCT_BRR = 0x0120,\n    DRCT_BLL = 0x0102\n}\n\n/** 棋盤格 */\nexport class Grid {\n    /** 原始陣列索引 */\n    public readonly i: number;\n\n    constructor(\n        /** 所屬棋盤 */\n        public readonly board: GridBoard,\n        /** X座標 */\n        public readonly x: number,\n        /** Y座標 */\n        public readonly y: number\n    ) {\n        this.i = x * board.height + y;\n    }\n\n    /**\n     * 取得相對位置的棋盤格\n     * @param drct 方向，使用 GRID_DRCT 可簡單取得\n     */\n    getGrid(drct: number) {\n        let f = (0xF000 & drct) >> 12;\n        let b = (0x0F00 & drct) >> 8;\n        let r = (0x00F0 & drct) >> 4;\n        let l = (0x000F & drct);\n\n        let x = this.x + r - l;\n        let y = this.y + b - f;\n\n        return this.board.getGrid(x, y);\n    }\n}\n\n/** 棋盤 */\nexport class GridBoard {\n    /** 所有棋盤格 */\n    public readonly grids: Grid[];\n    /** 棋盤格總數 */\n    public readonly length: number;\n\n    constructor(\n        /** 棋盤寬度 */\n        public readonly width: number,\n        /** 棋盤高度 */\n        public readonly height: number\n    ) {\n        let grids: Grid[] = [];\n\n        this.grids = grids;\n        this.length = width * height;\n\n        for (let x = 0; x < width; x++) {\n            for (let y = 0; y < height; y++) {\n                let grid = new Grid(this, x, y);\n                grids[grid.i] = grid;\n            }\n        }\n    }\n\n    /**\n     * 取得絕對位置的棋盤格\n     * @param x X座標\n     * @param y Y座標\n     */\n    getGrid(x: number, y: number) {\n        if (\n            x < 0 || x >= this.width ||\n            y < 0 || y >= this.height\n        ) return null;\n\n        let i = x * this.height + y;\n        return this.grids[i];\n    }\n}","const SVGNS = \"http://www.w3.org/2000/svg\";\ntype SVGAttr = { [name: string]: string };\n\n/**\n * 建立SVG元素\n * @param tagName SVG標籤名稱\n * @param attribute SVG屬性\n */\nexport function createSVG<T extends keyof SVGElementTagNameMap>(tagName: T, attribute?: SVGAttr): SVGElementTagNameMap[T] {\n    let element = document.createElementNS(SVGNS, tagName);\n    if (attribute) updateSVG(element, attribute);\n    return element;\n}\n\n/**\n * 變更SVG屬性\n * @param element SVG元素\n * @param attribute SVG屬性\n */\nexport function updateSVG(element: SVGElement, attribute: SVGAttr) {\n    for (let name in attribute) {\n        element.setAttribute(name, attribute[name]);\n    }\n}","import \"./scss/view/RelatiEffectView.scss\";\n\nimport { RelatiBoard } from \"./ts/core/RelatiBoard\";\nimport { RelatiGame } from \"./ts/core/RelatiGame\";\nimport { BY_COMMON_RELATI } from \"./ts/core/RelatiRoutes\";\nimport { RelatiBoardView } from \"./ts/view/RelatiBoardView\";\nimport { createRelatiEffect, createHintEffect } from \"./ts/view/RelatiEffectView\";\n\nvar board = new RelatiBoard(9, 9);\nvar game = new RelatiGame(board, BY_COMMON_RELATI);\nvar boardView = new RelatiBoardView(board, document.body);\n\nboardView.resize();\nwindow.addEventListener(\"resize\", boardView.resize.bind(boardView));\n\nboardView.view.addEventListener(\"click\", function (event: MouseEvent) {\n    var x: number = Math.floor(event.offsetX / 5),\n        y: number = Math.floor(event.offsetY / 5);\n\n    var playerSymbol = game.nowPlayerSymbol;\n\n    game.selectGrid(x, y);\n\n    var { background } = boardView;\n    var nowPlayerSymbol = game.nowPlayerSymbol;\n\n    boardView.update();\n    boardView.removeBackground();\n\n    createHintEffect(game.getPlaceableGrid(nowPlayerSymbol), nowPlayerSymbol, background);\n    createRelatiEffect(playerSymbol, background, game);\n});\n\n(window as any).game = game;","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/resolve-url-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./RelatiEffectView.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/resolve-url-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./RelatiEffectView.scss\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/resolve-url-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./RelatiEffectView.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"svg .relati-effect-line {\\n  stroke-dashoffset: 0;\\n  stroke-dasharray: 15;\\n  opacity: 0.3;\\n  animation: relati-effect-line 0.25s linear; }\\n\\n@keyframes relati-effect-line {\\n  0% {\\n    stroke-dashoffset: 15; } }\\n\", \"\"]);\n\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return '@media ' + item[2] + '{' + content + '}';\n      } else {\n        return content;\n      }\n    }).join('');\n  }; // import a list of modules into the list\n\n\n  list.i = function (modules, mediaQuery) {\n    if (typeof modules === 'string') {\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    for (var i = 0; i < this.length; i++) {\n      var id = this[i][0];\n\n      if (id != null) {\n        alreadyImportedModules[id] = true;\n      }\n    }\n\n    for (i = 0; i < modules.length; i++) {\n      var item = modules[i]; // skip already imported module\n      // this implementation is not 100% perfect for weird media query combinations\n      // when a module is imported multiple times with different media queries.\n      // I hope this will never occur (Hey this way we have smaller bundles)\n\n      if (item[0] == null || !alreadyImportedModules[item[0]]) {\n        if (mediaQuery && !item[2]) {\n          item[2] = mediaQuery;\n        } else if (mediaQuery) {\n          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';\n        }\n\n        list.push(item);\n      }\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || '';\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n  return '/*# ' + data + ' */';\n}","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","import { RelatiBoard, RELATI_LAUNCHER, RELATI_REPEATER, RELATI_RECEIVER, RelatiGrid } from \"./RelatiBoard\";\nimport { hasRelatiRoutesBy } from \"./RelatiRoutes\";\nimport { destoryRepeaterBy, restoreRepeaterBy } from \"./RelatiAction\";\n\nexport class RelatiGame {\n    public turn = 0;\n\n    constructor(\n        public board: RelatiBoard,\n        public routeType: number\n    ) { }\n\n    selectGrid(x: number, y: number) {\n        let grid = this.board.getGrid(x, y);\n        if (!grid.isSpace) return;\n\n        let symbol = this.nowPlayerSymbol;\n        let { routeType, board } = this;\n\n        if (this.turn < 2) {\n            grid.symbol = symbol;\n            grid.gain(RELATI_LAUNCHER);\n        } else if (hasRelatiRoutesBy(grid, symbol | RELATI_REPEATER, routeType)) {\n            grid.symbol = symbol;\n            grid.gain(RELATI_RECEIVER);\n        } else return;\n\n        this.turn++;\n        destoryRepeaterBy(board);\n        restoreRepeaterBy(board, routeType);\n    }\n\n    getPlaceableGrid(symbol: number) {\n        let grids: RelatiGrid[] = [];\n\n        for (let grid of this.board.grids) {\n            if (grid.isSpace && hasRelatiRoutesBy(\n                grid,\n                symbol | RELATI_REPEATER,\n                this.routeType\n            )) grids.push(grid);\n        }\n\n        return grids;\n    }\n\n    get nowPlayerSymbol() {\n        return this.turn % 2 + 1;\n    }\n\n    get result() {\n        if (this.turn < 2) return \"none\";\n\n        let placeableGrid = [\n            this.getPlaceableGrid(0),\n            this.getPlaceableGrid(1)\n        ];\n\n        if (\n            placeableGrid[0].length &&\n            placeableGrid[1].length\n        ) return \"none\";\n\n        if (placeableGrid[0].length) return \"OWin\";\n        if (placeableGrid[1].length) return \"XWin\";\n\n        return \"draw\";\n    }\n}","import { RelatiGrid, RelatiBoard, RELATI_LAUNCHER, RELATI_REPEATER, RELATI_RECEIVER } from \"./RelatiBoard\";\nimport { getRelatiRoutesBy } from \"./RelatiRoutes\";\n\n/**\n * 恢復棋盤格Relati的中繼機能\n * @param grid 棋盤格\n * @param routeType 路徑類型\n */\nfunction restore(grid: RelatiGrid, routeType: number) {\n    if (grid.is(RELATI_REPEATER)) return;\n    grid.gain(RELATI_REPEATER);\n    let routes = getRelatiRoutesBy(grid, grid.symbol | RELATI_RECEIVER, routeType);\n    for (let targetGrid of routes) restore(targetGrid, routeType);\n}\n\n/**\n * 恢復Relati中繼機能\n * @param board 棋盤\n * @param routeType 路徑類型\n */\nexport function restoreRepeaterBy(board: RelatiBoard, routeType: number) {\n    for (let grid of board.grids) {\n        if (grid.is(RELATI_LAUNCHER)) restore(grid, routeType);\n    }\n}\n\n/**\n * 破壞Relati中繼機能\n * @param board 棋盤\n */\nexport function destoryRepeaterBy(board: RelatiBoard) {\n    for (let grid of board.grids) {\n        grid.lost(RELATI_REPEATER);\n    }\n}","import { createSVG, updateSVG } from \"../core/SVGProcess\";\nimport {\n    RelatiGrid, RelatiBoard,\n    RELATI_SYMBOL_N, RELATI_SYMBOL_O, RELATI_SYMBOL_X,\n    RELATI_LAUNCHER, RELATI_REPEATER\n} from \"../core/RelatiBoard\";\n\nexport class RelatiBoardView {\n    public gridViews: RelatiGridView[] = [];\n    public view: SVGSVGElement = createSVG(\"svg\");\n    public background: SVGGElement = createSVG(\"g\");\n\n    constructor(public board: RelatiBoard, public container: HTMLElement) {\n        updateSVG(this.view, {\n            \"width\": `${board.width * 5}`,\n            \"height\": `${board.height * 5}`\n        });\n\n        let linesContainer = createSVG(\"g\");\n\n        let lineAttr = {\n            \"d\": \"\",\n            \"stroke\": \"#888\",\n            \"stroke-width\": \"0.4\"\n        };\n\n        for (let x = 1; x < board.width; x++) {\n            lineAttr[\"d\"] = `M ${x * 5} 0 V ${board.height * 5}`;\n            let line = createSVG(\"path\", lineAttr);\n            linesContainer.appendChild(line);\n        }\n\n        for (let y = 1; y < board.height; y++) {\n            lineAttr[\"d\"] = `M 0 ${y * 5} H ${board.width * 5}`;\n            let line = createSVG(\"path\", lineAttr);\n            linesContainer.appendChild(line);\n        }\n\n        container.appendChild(this.view);\n        this.view.appendChild(this.background);\n        this.view.appendChild(linesContainer);\n\n        for (let grid of board.grids) {\n            let gridView = new RelatiGridView(this, grid);\n            this.gridViews.push(gridView);\n            this.view.appendChild(gridView.view);\n        }\n\n        this.resize();\n        window.addEventListener(\"resize\", this.resize.bind(this));\n    }\n\n    resize() {\n        let { container, board: { width, height } } = this;\n\n        this.view.style.transform = \"scale(\" + Math.min(\n            container.clientWidth / (width * 5),\n            container.clientHeight / (height * 5)\n        ) * 0.95 + \")\";\n    }\n\n    update() {\n        for (let i = 0; i < this.gridViews.length; i++) {\n            let gridView = this.gridViews[i];\n            gridView.update();\n        }\n    }\n\n    removeBackground() {\n        let { background } = this;\n        let childCount = background.childNodes.length;\n        while (childCount-- > 0) background.removeChild(background.childNodes[0]);\n    }\n}\n\nexport class RelatiGridView {\n    public body: number = 0;\n    public view: SVGGElement = createSVG(\"g\");\n\n    constructor(public boardView: RelatiBoardView, public grid: RelatiGrid) {\n        this.body = grid.body;\n    }\n\n    update() {\n        let { grid } = this;\n\n        if (this.body === grid.body) return;\n\n        let symbolAttr = {\n            \"d\": \"\",\n            \"fill\": \"none\",\n            \"stroke\": \"\",\n            \"stroke-width\": \"0.6\"\n        };\n\n        let srtX = grid.x * 5 + 1;\n        let srtY = grid.y * 5 + 1;\n        let endX = grid.x * 5 + 4;\n        let endY = grid.y * 5 + 4;\n\n        switch (grid.body & 0b00000111) {\n            case RELATI_SYMBOL_N: {\n                let childCount = this.view.childNodes.length;\n                while (childCount-- > 0) this.view.removeChild(this.view.childNodes[0]);\n                break;\n            }\n\n            case RELATI_SYMBOL_O: {\n                symbolAttr[\"d\"] = (\n                    `M ${srtX + 1.5} ${srtY + 1.5} ` +\n                    \"m 0 -1.5 \" +\n                    \"a 1.5 1.5 0 0 1, 0 3 \" +\n                    \"a 1.5 1.5 0 0 1, 0 -3\"\n                );\n                symbolAttr[\"stroke\"] = \"crimson\";\n                break;\n            }\n\n            case RELATI_SYMBOL_X: {\n                symbolAttr[\"d\"] = (\n                    `M ${srtX} ${srtY} L ${endX} ${endY} ` +\n                    `M ${endX} ${srtY} L ${srtX} ${endY}`\n                );\n                symbolAttr[\"stroke\"] = \"royalblue\";\n                break;\n            }\n        }\n\n        if (!this.body) {\n            if (!grid.isSpace) {\n                if (grid.is(RELATI_LAUNCHER)) {\n                    symbolAttr[\"stroke-width\"] = \"1.2\";\n                    this.view.appendChild(createSVG(\"path\", symbolAttr));\n\n                    symbolAttr[\"stroke-width\"] = \"0.6\";\n                    symbolAttr[\"stroke\"] = \"#f2f2f2\";\n                    this.view.appendChild(createSVG(\"path\", symbolAttr));\n                } else if (grid.is(RELATI_REPEATER)) {\n                    this.view.appendChild(createSVG(\"path\", symbolAttr));\n                } else {\n                    symbolAttr[\"stroke\"] = \"#666\";\n                    this.view.appendChild(createSVG(\"path\", symbolAttr));\n                }\n            }\n        } else if (!grid.is(RELATI_LAUNCHER)) {\n            let color = symbolAttr[\"stroke\"];\n\n            if (!grid.is(RELATI_REPEATER)) color = \"#666\";\n            let childCount = this.view.childNodes.length;\n\n            while (childCount-- > 0) updateSVG(\n                this.view.childNodes[childCount] as SVGElement,\n                { \"stroke\": color }\n            );\n        }\n\n        this.body = grid.body;\n    }\n}","import { createSVG } from \"../core/SVGProcess\";\nimport { RelatiGrid, RELATI_LAUNCHER, RELATI_RECEIVER } from \"../core/RelatiBoard\";\nimport { getRelatiTracesBy } from \"../core/RelatiRoutes\";\nimport { RelatiGame } from \"../core/RelatiGame\";\n\nconst RELATI_EFFECTED = 0b10000000;\nconst SYMBOL_COLOR = [\"#666\", \"crimson\", \"royalblue\"];\n\nlet dotAttr = {\n    \"cx\": \"\",\n    \"cy\": \"\",\n    \"r\": \"0.5\",\n    \"fill\": \"\"\n};\n\nfunction createDot(x: number, y: number, color: string) {\n    dotAttr[\"cx\"] = `${x * 5 + 2.5}`;\n    dotAttr[\"cy\"] = `${y * 5 + 2.5}`;\n    dotAttr[\"fill\"] = color;\n    return createSVG(\"circle\", dotAttr);\n}\n\nexport function createHintEffect(grids: RelatiGrid[], symbol: number, view: SVGElement) {\n    let color = SYMBOL_COLOR[symbol];\n    for (let { x, y } of grids) {\n        view.appendChild(createDot(x, y, color));\n    }\n}\n\nlet lineAttr = {\n    \"d\": \"\",\n    \"stroke-width\": \"0.5\",\n    \"stroke\": \"\",\n    \"fill\": \"none\",\n    \"class\": \"relati-effect-line\"\n};\n\nfunction createLine(source: RelatiGrid, traces: RelatiGrid[], color: string, view: SVGElement) {\n    lineAttr[\"d\"] = `M ${source.x * 5 + 2.5} ${source.y * 5 + 2.5}`;\n    lineAttr[\"stroke\"] = color;\n\n    for (let grid of traces) {\n        lineAttr[\"d\"] += ` L ${grid.x * 5 + 2.5} ${grid.y * 5 + 2.5}`;\n    }\n\n    let path = createSVG(\"path\", lineAttr);\n    view.appendChild(path);\n}\n\nexport function createRelatiEffect(symbol: number, view: SVGElement, game: RelatiGame) {\n    let { board: { grids }, routeType, turn } = game;\n    let color = SYMBOL_COLOR[symbol];\n\n    for (let grid of grids) grid.lost(RELATI_EFFECTED);\n\n    for (let grid of grids) {\n        if (grid.is(RELATI_LAUNCHER) && grid.symbol == symbol) {\n            createRelatiLine(grid, color, view, routeType, turn, game);\n        }\n    }\n}\n\nfunction createRelatiLine(grid: RelatiGrid, color: string, view: SVGElement, routeType: number, turn: number, game: RelatiGame) {\n    if (grid.is(RELATI_EFFECTED) || game.turn > turn) return;\n    grid.gain(RELATI_EFFECTED);\n\n    setTimeout(() => {\n        if (game.turn > turn) return;\n        let traces = getRelatiTracesBy(grid, grid.symbol | RELATI_RECEIVER, routeType);\n\n        for (let grids of traces) {\n            let targetGrid = grids[grids.length - 1];\n\n            if (!targetGrid.is(RELATI_EFFECTED)) {\n                createLine(grid, grids, color, view);\n                createRelatiLine(targetGrid, color, view, routeType, turn, game);\n            }\n        }\n    }, 250);\n}"],"sourceRoot":""}