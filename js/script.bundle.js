!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),n=i.GRID_DRCT.DRCT_F,a=i.GRID_DRCT.DRCT_B,o=i.GRID_DRCT.DRCT_R,s=i.GRID_DRCT.DRCT_L,l=i.GRID_DRCT.DRCT_FR,c=i.GRID_DRCT.DRCT_FL,u=i.GRID_DRCT.DRCT_BR,f=i.GRID_DRCT.DRCT_BL,h=i.GRID_DRCT.DRCT_2F,d=i.GRID_DRCT.DRCT_2B,R=i.GRID_DRCT.DRCT_2R,p=i.GRID_DRCT.DRCT_2L,v=i.GRID_DRCT.DRCT_2FR,y=i.GRID_DRCT.DRCT_2FL,_=i.GRID_DRCT.DRCT_2BR,g=i.GRID_DRCT.DRCT_2BL,b=i.GRID_DRCT.DRCT_FFR,m=i.GRID_DRCT.DRCT_FFL,T=i.GRID_DRCT.DRCT_BBR,C=i.GRID_DRCT.DRCT_BBL,D=i.GRID_DRCT.DRCT_FRR,G=i.GRID_DRCT.DRCT_FLL,w=i.GRID_DRCT.DRCT_BRR,L=i.GRID_DRCT.DRCT_BLL,B=[n,a,o,s,l,c,u,f],E=[[h,n],[d,a],[R,o],[p,s],[v,l],[y,c],[_,u],[g,f]],S=[[b,h,n],[b,l,n],[b,l,o],[m,h,n],[m,c,n],[m,c,s],[T,d,a],[T,u,a],[T,u,o],[C,d,a],[C,f,a],[C,f,s],[D,l,n],[D,R,o],[D,l,o],[G,c,n],[G,p,s],[G,c,s],[w,u,a],[w,R,o],[w,u,o],[L,f,a],[L,p,s],[L,f,s]];t.BY_NORMAL_RELATI=0,t.BY_COMMON_RELATI=1,t.RelatiRouteRule={allow:function(e,r,i,n){switch(n){case t.BY_COMMON_RELATI:for(var a=0;a<24;a++){var o=e.getGrid(S[a][0]),s=e.getGrid(S[a][1]),l=e.getGrid(S[a][2]);if(o&&o.symbol==r&&o.is(i,"any")&&s.isSpace&&l.isSpace)return!0}for(a=0;a<8;a++){o=e.getGrid(E[a][0]);var c=e.getGrid(E[a][1]);if(o&&o.symbol==r&&o.is(i,"any")&&c.isSpace)return!0}case t.BY_NORMAL_RELATI:for(a=0;a<8;a++){if((o=e.getGrid(B[a]))&&o.symbol==r&&o.is(i,"any"))return!0}}return!1},trace:function(e,r,i,n){var a=[];switch(n){case t.BY_COMMON_RELATI:for(var o=0;o<24;o++){var s=e.getGrid(S[o][0]),l=e.getGrid(S[o][1]),c=e.getGrid(S[o][2]);s&&s.symbol==r&&s.is(i,"any")&&l.isSpace&&c.isSpace&&a.push({type:"remote-stable",grids:[s,l,c]})}for(o=0;o<8;o++){s=e.getGrid(E[o][0]);var u=e.getGrid(E[o][1]);s&&s.symbol==r&&s.is(i,"any")&&u.isSpace&&a.push({type:"remote-normal",grids:[s,u]})}case t.BY_NORMAL_RELATI:for(o=0;o<8;o++){(s=e.getGrid(B[o]))&&s.symbol==r&&s.is(i,"any")&&a.push({type:"normal",grids:[s]})}}return a}}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function t(){var e;(e=document.getElementsByClassName("page active")[0])&&e.classList.remove("active"),(e=document.querySelector(location.hash+"-page"))&&e.classList.add("active")}e.switchTo=function(e){location.hash=e},window.addEventListener("hashchange",t),t()}(t.Page||(t.Page={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),n=["relati-repeater"];t.PlacementRule={allow:function(e,t,r){return!e.symbol&&i.RelatiRouteRule.allow(e,t,n,r)},trace:function(e,r,i){for(var n=[],a=0,o=e.board.grids;a<o.length;a++){var s=o[a];!s.symbol&&t.PlacementRule.allow(s,r,i||e.routeType)&&n.push(s)}return n}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t;function r(){e.view.className="none"}function i(e){t&&t(e),t=null,r()}e.view=document.getElementById("message-box"),e.messageContent=document.getElementById("message-content"),e.acceptButton=document.getElementById("message-accept"),e.rejectButton=document.getElementById("message-reject"),e.verifyButton=document.getElementById("message-verify"),e.show=function(r,i,n){e.view.className=r,e.messageContent.innerText=i,e.messageContent.style.display=i?"":"none",t=n},e.hide=r,e.response=i,e.acceptButton.addEventListener("click",function(e){return i("accept")}),e.rejectButton.addEventListener("click",function(e){return i("reject")}),e.verifyButton.addEventListener("click",function(e){return i("verify")})}(t.MessageBox||(t.MessageBox={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.DRCT_C=0]="DRCT_C",e[e.DRCT_F=4096]="DRCT_F",e[e.DRCT_B=256]="DRCT_B",e[e.DRCT_R=16]="DRCT_R",e[e.DRCT_L=1]="DRCT_L",e[e.DRCT_FR=4112]="DRCT_FR",e[e.DRCT_FL=4097]="DRCT_FL",e[e.DRCT_BR=272]="DRCT_BR",e[e.DRCT_BL=257]="DRCT_BL",e[e.DRCT_2F=8192]="DRCT_2F",e[e.DRCT_2B=512]="DRCT_2B",e[e.DRCT_2R=32]="DRCT_2R",e[e.DRCT_2L=2]="DRCT_2L",e[e.DRCT_2FR=8224]="DRCT_2FR",e[e.DRCT_2FL=8194]="DRCT_2FL",e[e.DRCT_2BR=544]="DRCT_2BR",e[e.DRCT_2BL=514]="DRCT_2BL",e[e.DRCT_FFR=8208]="DRCT_FFR",e[e.DRCT_FFL=8193]="DRCT_FFL",e[e.DRCT_BBR=528]="DRCT_BBR",e[e.DRCT_BBL=513]="DRCT_BBL",e[e.DRCT_FRR=4128]="DRCT_FRR",e[e.DRCT_FLL=4098]="DRCT_FLL",e[e.DRCT_BRR=288]="DRCT_BRR",e[e.DRCT_BLL=258]="DRCT_BLL"}(t.GRID_DRCT||(t.GRID_DRCT={}));var i=function(){function e(e,t,r){this.board=e,this.x=t,this.y=r,this.i=t*e.height+r}return e.prototype.getGrid=function(e){var t=(61440&e)>>12,r=(3840&e)>>8,i=(240&e)>>4,n=15&e,a=this.x+i-n,o=this.y+r-t;return this.board.getGrid(a,o)},e}();t.Grid=i;var n=function(){function e(e,t){this.width=e,this.height=t;var r=[];this.grids=r,this.length=e*t;for(var n=0;n<e;n++)for(var a=0;a<t;a++){var o=new i(this,n,a);r[o.i]=o}}return e.prototype.getGrid=function(e,t){if(e<0||e>=this.width||t<0||t>=this.height)return null;var r=e*this.height+t;return this.grids[r]},e}();t.GridBoard=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="http://www.w3.org/2000/svg";function n(e,t){for(var r in t)e.setAttribute(r,t[r])}t.createSVG=function(e,t){var r=document.createElementNS(i,e);return t&&n(r,t),r},t.updateSVG=n,t.appendSVGChild=function(e,t){for(var r=0,i=t;r<i.length;r++){var n=i[r];e.appendChild(n)}},t.removeSVGChild=function(e){for(var t=e.childNodes.length;t-- >0;)e.removeChild(e.childNodes[0])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),n=r(6);r(10),r(11),r(22),location.hash||i.Page.switchTo("main"),window.MessageBox=n.MessageBox},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),n=document.getElementById("main-to-game"),a=document.getElementById("main-to-help");n.addEventListener("click",function(e){return i.Page.switchTo("game")}),a.addEventListener("click",function(e){return i.Page.switchTo("help")})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),n=r(12),a=r(15),o=r(16),s=r(2),l=r(17),c=r(18),u=r(5),f=r(6),h=r(19),d=r(20),R=r(21),p=r(53);document.getElementById("game-to-main").addEventListener("click",function(e){f.MessageBox.show("confirm accept reject","確認離開？",function(e){"accept"==e&&i.Page.switchTo("main")})});var v=new a.RelatiBoard(9,9),y=[new o.RelatiPlayer("O"),new o.RelatiPlayer("X")],_=[p.AttackTarget],g=[h.Placement,p.Attack],b=[R.RelatiNormalTypeCount,d.DestoryRepeater,d.RestoreRepeater],m=new n.RelatiGame(v,y,s.BY_COMMON_RELATI,_,g,b),T=document.getElementById("game-board"),C=new l.RelatiBoardView(m,T);window.addEventListener("hashchange",function(){"#game"==location.hash&&m.restart()}),C.context.addEventListener("click",function(e){var t=Math.floor(e.offsetX/5),r=Math.floor(e.offsetY/5),i=v.getGrid(t,r);m.selectGrid&&m.selectGrid(i)}),m.onstart=C.remove.bind(C),m.onend=function(e){var t="",r="";switch(e){case 1:t="owin",r="圈方獲勝！";break;case 2:t="xwin",r="叉方獲勝！";break;case 3:t="draw",r="無人獲勝！"}f.MessageBox.show(t+" accept reject",r,function(e){"accept"==e&&m.restart()})};var D="";m.onturnstart=function(){return D=m.nowPlayer.symbol},m.ongridselect=C.update.bind(C),m.onturnend=function(){C.update();var e=m.nowPlayer.symbol,t=u.PlacementRule.trace(m,e,s.BY_COMMON_RELATI);c.createHintEffect(t,e,C.layers[1]),c.createRelatiEffect(D,C.layers[0],m)},window.game=m},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(o,s)}l((i=i.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=r(14),s=function(){function e(e,t,r,i,n,a){this.board=e,this.players=t,this.routeType=r,this.roleInitEffects=i,this.roleActions=n,this.rolePassEffects=a,this.turn=0,this.history=[],this.start()}return e.prototype.start=function(){return i(this,void 0,void 0,function(){var e,t,r,i,a,s,l,c,u;return n(this,function(n){switch(n.label){case 0:e=o.GAME_RESULT_NONE,this.onstart&&this.onstart(),n.label=1;case 1:return e!=o.GAME_RESULT_NONE?[3,15]:[4,this.gridSelect()];case 2:if(!(t=n.sent()))return[3,1];this.onturnstart&&this.onturnstart(t),this.selectedGrid=t,r=0,i=this.roleInitEffects,n.label=3;case 3:return r<i.length?[4,i[r].do(this)]:[3,6];case 4:n.sent(),n.label=5;case 5:return r++,[3,3];case 6:this.selectedGrid=t,a=!1,s=0,l=this.roleActions,n.label=7;case 7:return s<l.length?[4,l[s].do(t,this)]:[3,10];case 8:if(n.sent())return a=!0,[3,10];n.label=9;case 9:return s++,[3,7];case 10:if(!a)return[3,1];this.selectedGrid=t,c=0,u=this.rolePassEffects,n.label=11;case 11:return c<u.length?[4,u[c].do(this)]:[3,14];case 12:n.sent(),n.label=13;case 13:return c++,[3,11];case 14:return this.turn++,delete this.selectedGrid,e=o.WinnerDecision.state(this),this.onturnend&&this.onturnend(t),[3,1];case 15:return this.onend&&this.onend(e),[2,e]}})})},e.prototype.restart=function(){this.turn=0;for(var e=0,t=this.board.grids;e<t.length;e++){var r=t[e];r.symbol="",r.lost(a.AllRelatiStatus)}this.start()},e.prototype.gridSelect=function(){var e=this;return new Promise(function(t){e.selectGrid=function(r){t(r),e.ongridselect&&e.ongridselect(r)}})},Object.defineProperty(e.prototype,"nowPlayer",{get:function(){return this.players[this.turn%2]},enumerable:!0,configurable:!0}),e}();t.RelatiGame=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelatiStatusList=["relati-launcher","relati-repeater","relati-receiver","attack-selected","effect-activate"],t.AllRelatiStatus=t.RelatiStatusList,t.RelatiSymbolList=["","O","X"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(5);t.GAME_RESULT_NONE=0,t.GAME_RESULT_OWIN=1,t.GAME_RESULT_XWIN=2,t.GAME_RESULT_DRAW=3,t.WinnerDecision={state:function(e){if(e.turn<2)return t.GAME_RESULT_NONE;var r=e.nowPlayer,n=i.PlacementRule.trace(e,"O"),a=i.PlacementRule.trace(e,"X"),o=null!=n[0],s=null!=a[0];if(o&&s)return t.GAME_RESULT_NONE;if("O"==r.symbol){if(o)return t.GAME_RESULT_NONE;if(s)return t.GAME_RESULT_XWIN}else if("X"==r.symbol){if(s)return t.GAME_RESULT_NONE;if(o)return t.GAME_RESULT_OWIN}return t.GAME_RESULT_DRAW}}},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(7),o=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this;return n.symbol="",n.status={},n}return n(t,e),t.prototype.is=function(e,t){if("string"==typeof e)return this.status[e];var r=e;if("all"===t){for(var i=0,n=r;i<n.length;i++){var a=n[i];if(!this.status[a])return!1}return!0}for(var o=0,s=r;o<s.length;o++){var l=s[o];if(this.status[l])return!0}return!1},t.prototype.gain=function(e){if("string"==typeof e)return this.status[e]=!0;for(var t=0,r=e;t<r.length;t++){var i=r[t];this.status[i]=!0}},t.prototype.lost=function(e){if("string"==typeof e)return this.status[e]=!1;for(var t=0,r=e;t<r.length;t++){var i=r[t];this.status[i]=!1}},Object.defineProperty(t.prototype,"isSpace",{get:function(){return""===this.symbol||!this.is(["relati-receiver","relati-launcher"],"any")},enumerable:!0,configurable:!0}),t}(a.Grid);t.RelatiGrid=o;var s=function(e){function t(t,r){for(var i=e.call(this,t,r)||this,n=0;n<t;n++)for(var a=0;a<r;a++){var s=new o(i,n,a);i.grids[s.i]=s}return i}return n(t,e),t}(a.GridBoard);t.RelatiBoard=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e){this.symbol=e,this.status={},this.points={},this.params={}}}();t.RelatiPlayer=i},function(e,t,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),a=function(){function e(e,t){this.game=e,this.container=t,this.context=n.createSVG("svg"),this.gridViews=[];var r=e.board;n.updateSVG(this.context,{width:""+5*r.width,height:""+5*r.height});var i=n.createSVG("g"),a=n.createSVG("g"),l=n.createSVG("g"),c=n.createSVG("g");!function(e,t){for(var r=1;r<e.width;r++){o.d="M "+5*r+" 0 V "+5*e.height;var i=n.createSVG("path",o);t.appendChild(i)}for(var a=1;a<e.height;a++){o.d="M 0 "+5*a+" H "+5*e.width;var i=n.createSVG("path",o);t.appendChild(i)}}(r,l),this.layers=[i,a,l,c],n.appendSVGChild(this.context,this.layers);for(var u=0,f=r.grids;u<f.length;u++){var h=f[u],d=new s(h);c.appendChild(d.context),c.appendChild(d.feature),this.gridViews.push(d)}this.container.appendChild(this.context),this.resize(),window.addEventListener("resize",this.resize.bind(this))}return e.prototype.resize=function(){var e=this.container,t=this.game.board,r=t.width,i=t.height;this.context.style.transform="scale("+.95*Math.min(e.clientWidth/(5*r),e.clientHeight/(5*i))+")"},e.prototype.update=function(){for(var e=0,t=this.gridViews;e<t.length;e++){t[e].update()}},e.prototype.remove=function(){for(var e=0,t=this.gridViews;e<t.length;e++){t[e].remove()}n.removeSVGChild(this.layers[0]),n.removeSVGChild(this.layers[1])},e}();t.RelatiBoardView=a;var o={d:"",stroke:"#888","stroke-width":"0.4"};var s=function(){function e(e){this.grid=e,this.feature=n.createSVG("g"),this.context=n.createSVG("g"),this.symbol="",this.status={},this.symbol=e.symbol,this.status=i({},e.status),this.update()}return e.prototype.update=function(){var e=this.grid;if(this.symbol!=e.symbol||this.status["relati-launcher"]!=e.status["relati-launcher"]||this.status["relati-repeater"]!=e.status["relati-repeater"]||this.status["relati-receiver"]!=e.status["relati-receiver"]||this.status["attack-selected"]!=e.status["attack-selected"]){var t={d:"",fill:"none",stroke:"","stroke-width":"0.6"},r=5*e.x+1,a=5*e.y+1,o=5*e.x+4,s=5*e.y+4;switch(e.symbol){case"":n.removeSVGChild(this.context);break;case"O":t.d="M "+(r+1.5)+" "+(a+1.5)+" m 0 -1.5 a 1.5 1.5 0 0 1, 0 3 a 1.5 1.5 0 0 1, 0 -3",t.stroke="crimson";break;case"X":t.d="M "+r+" "+a+" L "+o+" "+s+" M "+o+" "+a+" L "+r+" "+s,t.stroke="royalblue"}if(e.is("relati-repeater")||(t.stroke="#666"),e.is(["relati-launcher","relati-receiver"],"any")||(t.stroke="#bbb"),this.symbol){var l=t.stroke;n.updateSVG(this.context.childNodes[0],{stroke:l})}else e.isSpace||(e.is("relati-launcher")?(t["stroke-width"]="1.2",this.context.appendChild(n.createSVG("path",t)),t["stroke-width"]="0.6",t.stroke="#f2f2f2",this.context.appendChild(n.createSVG("path",t))):e.is("relati-repeater")?this.context.appendChild(n.createSVG("path",t)):(e.is("relati-receiver"),this.context.appendChild(n.createSVG("path",t))));this.symbol=e.symbol,this.status=i({},e.status)}},e.prototype.remove=function(){this.symbol="",this.status={},n.removeSVGChild(this.context),n.removeSVGChild(this.feature)},e}();t.RelatiGridView=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(8),n=r(2),a={"":"#666",O:"crimson",X:"royalblue"},o={cx:"",cy:"",r:"0.5",fill:""};function s(e,t,r){return o.cx=""+(5*e+2.5),o.cy=""+(5*t+2.5),o.fill=r,i.createSVG("circle",o)}t.createHintEffect=function(e,t,r){var n=a[t];i.removeSVGChild(r);for(var o=0,l=e;o<l.length;o++){var c=l[o],u=c.x,f=c.y;r.appendChild(s(u,f,n))}};var l={d:"","stroke-width":"0.5",stroke:"",fill:"none",class:"relati-effect-line"};function c(e,t,r,n){l.d="M "+(5*e.x+2.5)+" "+(5*e.y+2.5),l.stroke=r;for(var a=0,o=t;a<o.length;a++){var s=o[a];l.d+=" L "+(5*s.x+2.5)+" "+(5*s.y+2.5)}var c=i.createSVG("path",l);n.appendChild(c)}function u(e,t,r,i,a,o){e.is("effect-activate")||o.turn>a||(e.gain("effect-activate"),setTimeout(function(){if(!(o.turn>a))for(var s=0,l=n.RelatiRouteRule.trace(e,e.symbol,["relati-receiver"],i);s<l.length;s++){var f=l[s].grids;f.reverse();var h=f[f.length-1];h.is("effect-activate")||(c(e,f,t,r),u(h,t,r,i,a,o))}},250))}t.createRelatiEffect=function(e,t,r){var n=r.board.grids,o=r.routeType,s=r.turn,l=a[e];i.removeSVGChild(t);for(var c=0,f=n;c<f.length;c++)(R=f[c]).lost("effect-activate");for(var h=0,d=n;h<d.length;h++){var R;(R=d[h]).is("relati-launcher")&&R.symbol==e&&u(R,l,t,o,s,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(5);t.Placement={do:function(e,t){if(!e.isSpace)return!1;var r=t.nowPlayer.symbol,n=t.routeType;if(t.turn<2)e.symbol=r,e.gain("relati-launcher");else{if(!i.PlacementRule.allow(e,r,n))return!1;e.symbol=r,e.gain("relati-receiver")}return t.history.push({turn:t.turn,type:"placement",grid:e}),!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),n=["relati-receiver"];function a(e,t){if(!e.is("relati-repeater")){e.gain("relati-repeater");for(var r=0,o=i.RelatiRouteRule.trace(e,e.symbol,n,t);r<o.length;r++){a(o[r].grids[0],t)}}}t.RestoreRepeater={do:function(e){for(var t=e.board,r=e.routeType,i=0,n=t.grids;i<n.length;i++){var o=n[i];o.is("relati-launcher")&&a(o,r)}}},t.DestoryRepeater={do:function(e){for(var t=0,r=e.board.grids;t<r.length;t++){r[t].lost("relati-repeater")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(2);t.RelatiNormalTypeCount={do:function(e){var t=e.turn,r=e.nowPlayer,n=e.history;if(!(t<2)){var a=n.filter(function(e){return e.grid.symbol==r.symbol}).reverse()[0];if("placement"==a.type)null==r.points["relati-normal-times"]&&(r.points["relati-normal-times"]=0),i.RelatiRouteRule.allow(a.grid,r.symbol,["relati-repeater"],i.BY_NORMAL_RELATI)?r.points["relati-normal-times"]++:r.points["relati-normal-times"]=0}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),n=r(6);document.getElementById("help-to-main").addEventListener("click",function(e){n.MessageBox.show("confirm accept reject","確認離開？",function(e){"accept"==e&&i.Page.switchTo("main")})})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(o,s)}l((i=i.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(54);t.Attack={do:function(e,t){return i(this,void 0,void 0,function(){var r,i;return n(this,function(n){switch(n.label){case 0:if(!(r=a.AttackRule.trace(e,t.nowPlayer))[0])return[2,!1];e.lost("attack-selected"),e.lost("relati-launcher"),e.lost("relati-repeater"),e.lost("relati-receiver"),t.ongridselect&&t.ongridselect(e),n.label=1;case 1:return[4,t.gridSelect()];case 2:i=n.sent(),n.label=3;case 3:if(r.indexOf(i)<0)return[3,1];n.label=4;case 4:return i.lost("relati-launcher"),i.lost("relati-repeater"),i.lost("relati-receiver"),t.history.push({turn:t.turn,type:"attack",grid:e}),[2,!0]}})})}},t.AttackTarget={do:function(e){for(var t=e.board,r=e.turn,i=e.players[(r+1)%2],n=0,o=t.grids;n<o.length;n++){var s=o[n];s.isSpace||(a.AttackRule.allow(s,i)?s.gain("attack-selected"):s.lost("attack-selected"))}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),n=[i.GRID_DRCT.DRCT_F,i.GRID_DRCT.DRCT_B,i.GRID_DRCT.DRCT_R,i.GRID_DRCT.DRCT_L];t.AttackRule={allow:function(e,t){if(e.symbol==t.symbol)return!1;if(t.points["relati-normal-times"]<5)return!1;for(var r,i,a=0,o=n;a<o.length;a++){var s=o[a];e:for(var l=1;l<10&&(r=e.getGrid(s*l));l++)if(r.symbol==t.symbol){if(r.is(["relati-launcher","relati-repeater"],"any"))for(var c=1;c<10;c++){if(!(i=r.getGrid(s*c)))break e;if(i.symbol==t.symbol){if(i.is(["relati-launcher","relati-receiver"],"any"))return!0}else if(""!=i.symbol&&i.is(["relati-receiver","relati-launcher"],"any"))break e}}else if(""!=r.symbol&&r.is(["relati-receiver","relati-launcher"],"any"))break}return!1},trace:function(e,t){if(e.symbol==t.symbol)return[];if(t.points["relati-normal-times"]<5)return[];for(var r,i,a=[],o=0,s=n;o<s.length;o++){var l=s[o];e:for(var c=1;c<10&&(r=e.getGrid(l*c));c++)if(r.symbol==t.symbol){if(r.is(["relati-launcher","relati-repeater"],"any"))for(var u=1;u<10;u++){if(!(i=r.getGrid(l*u)))break e;if(i.symbol==t.symbol){if(i.is(["relati-launcher","relati-repeater"],"any")){a.push(i);break e}}else if(""!=i.symbol&&i.is(["relati-receiver","relati-launcher"],"any"))break e}}else if(""!=r.symbol&&r.is(["relati-receiver","relati-launcher"],"any"))break}return a}}}]);
//# sourceMappingURL=script.bundle.js.map